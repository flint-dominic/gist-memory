#!/bin/bash
# Gist Memory CLI wrapper
# Usage: gist recall "query"
#        gist remember "content" -t "title"
#        gist search "query"
#        gist stats

cd ~/clawd/gist-memory
source ~/clawd/.venv/bin/activate

case "$1" in
    recall|r)
        shift
        python src/recall.py "$@"
        ;;
    remember|rem)
        shift
        python src/remember.py "$@"
        ;;
    search|s)
        shift
        python src/retrieval.py search "$@"
        ;;
    encode|e)
        shift
        python src/encode.py "$@"
        ;;
    index|i)
        python src/retrieval.py index "$@"
        ;;
    stats|st)
        python src/retrieval.py stats
        ;;
    context|c)
        shift
        python src/context.py "$@"
        ;;
    inspect|in)
        shift
        python src/reinforcement.py inspect "$@"
        ;;
    boost|b)
        shift
        python src/reinforcement.py boost "$@"
        ;;
    decay|d)
        shift
        python src/reinforcement.py decay "$@"
        ;;
    reinforce-stats|rs)
        python src/reinforcement.py stats
        ;;
    help|--help|-h)
        echo "Gist Memory CLI"
        echo ""
        echo "Commands:"
        echo "  recall <query>     Recall memories relevant to query"
        echo "  remember <text>    Encode and save new memory"
        echo "  search <query>     Raw semantic search"
        echo "  context <msg>      Auto-inject relevant context"
        echo "  encode <file>      Encode file to memory YAML"
        echo "  index              Re-index all memories"
        echo "  stats              Show memory stats"
        echo ""
        echo "Reinforcement:"
        echo "  inspect <id>       Show full memory stats + reinforcement"
        echo "  boost <id> [--lock]  Boost memory salience (--lock = decay immune)"
        echo "  decay [threshold]  Show memories fading below threshold (default 0.3)"
        echo "  reinforce-stats    Show reinforcement statistics"
        echo ""
        echo "Examples:"
        echo "  gist recall 'what is fuzzy trace theory'"
        echo "  gist context 'what was the memory architecture based on'"
        echo "  gist remember 'content' -t 'title'"
        echo "  gist inspect mem-001-founding"
        echo "  gist boost mem-005-llmoblings --lock"
        ;;
    *)
        echo "Unknown command: $1"
        echo "Run 'gist help' for usage"
        exit 1
        ;;
esac
